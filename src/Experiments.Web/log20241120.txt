2024-11-20 12:48:08.293 +05:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2024-11-20 12:48:08.392 +05:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2024-11-20 12:48:08.398 +05:00 [INF] Applying migration '20241120061542_Initial'.
2024-11-20 12:48:08.420 +05:00 [INF] Applying migration '20241120074743_AuthConfirmation'.
2024-11-20 12:49:36.189 +05:00 [INF] Registered 7 endpoints in 92 milliseconds.
2024-11-20 12:49:36.792 +05:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 12:49:36.912 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 12:49:37.034 +05:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?', @p1='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Contributors" ("Name", "Status")
VALUES (@p0, @p1)
RETURNING "Id";
INSERT INTO "Contributors" ("Name", "Status")
VALUES (@p2, @p3)
RETURNING "Id";
2024-11-20 12:49:37.070 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 12:49:37.287 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 12:49:37.287 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 12:49:37.287 +05:00 [INF] Hosting environment: Development
2024-11-20 12:49:37.287 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 12:50:07.390 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/ - null null
2024-11-20 12:50:07.468 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/ - 404 0 null 81.2462ms
2024-11-20 12:50:07.481 +05:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:57679/, Response status code: 404
2024-11-20 12:50:10.336 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger - null null
2024-11-20 12:50:10.340 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger - 302 0 null 3.9906ms
2024-11-20 12:50:10.343 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/index.html - null null
2024-11-20 12:50:10.400 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/index.html - 200 null text/html; charset=utf-8 56.3679ms
2024-11-20 12:50:10.419 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/swagger-ui.css - null null
2024-11-20 12:50:10.420 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/swagger-ui-bundle.js - null null
2024-11-20 12:50:10.420 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/swagger-ui-standalone-preset.js - null null
2024-11-20 12:50:10.436 +05:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-11-20 12:50:10.436 +05:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2024-11-20 12:50:10.436 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/swagger-ui.css - 200 152073 text/css 17.3551ms
2024-11-20 12:50:10.436 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/swagger-ui-standalone-preset.js - 200 230294 text/javascript 15.712ms
2024-11-20 12:50:10.440 +05:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-11-20 12:50:10.440 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/swagger-ui-bundle.js - 200 1452754 text/javascript 20.5626ms
2024-11-20 12:50:10.455 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/swagger-ui-standalone-preset.js - null null
2024-11-20 12:50:10.455 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/swagger-ui-bundle.js - null null
2024-11-20 12:50:10.456 +05:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-11-20 12:50:10.457 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/swagger-ui-standalone-preset.js - 200 230294 text/javascript 1.8403ms
2024-11-20 12:50:10.459 +05:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-11-20 12:50:10.459 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/swagger-ui-bundle.js - 200 1452754 text/javascript 4.359ms
2024-11-20 12:50:11.042 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - null null
2024-11-20 12:50:11.050 +05:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2024-11-20 12:50:11.308 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - 200 null application/json; charset=utf-8 266.2923ms
2024-11-20 12:50:30.741 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/start - application/json 35
2024-11-20 12:50:30.746 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/start'
2024-11-20 12:50:30.796 +05:00 [INF] Handling AuthStartCommand
2024-11-20 12:50:30.796 +05:00 [INF] Property phoneNumber : +77072780241
2024-11-20 12:50:30.853 +05:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Boolean), @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AuthConfirmations" ("Id", "Code", "IsConfirmed", "PhoneNumber")
VALUES (@p0, @p1, @p2, @p3);
2024-11-20 12:50:30.855 +05:00 [INF] Handled AuthStartCommand with Ardalis.Result.Result`1[System.String] in 58 ms
2024-11-20 12:50:30.860 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/start'
2024-11-20 12:50:30.863 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/start - 200 null application/json; charset=utf-8 122.1303ms
2024-11-20 12:50:54.310 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 12:50:54.314 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 12:50:54.331 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 12:50:54.331 +05:00 [INF] Property confirmationId : 89fb0546-451e-48e2-966d-dee4d2bc76e9
2024-11-20 12:50:54.331 +05:00 [INF] Property code : 2823
2024-11-20 12:50:54.470 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 12:50:54.485 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "AspNetUsers" AS a
    WHERE a."PhoneNumber" = @__phoneNumber_0)
2024-11-20 12:50:54.489 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 157 ms
2024-11-20 12:50:54.495 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 12:50:54.496 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 400 null application/problem+json; charset=utf-8 186.5651ms
2024-11-20 12:57:04.074 +05:00 [INF] Application is shutting down...
2024-11-20 12:57:38.123 +05:00 [INF] Registered 7 endpoints in 92 milliseconds.
2024-11-20 12:57:38.721 +05:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 12:57:38.836 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 12:57:38.848 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 12:57:39.008 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 12:57:39.008 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 12:57:39.008 +05:00 [INF] Hosting environment: Development
2024-11-20 12:57:39.008 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 12:57:46.734 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 12:57:46.762 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 12:57:46.804 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 12:57:46.804 +05:00 [INF] Property confirmationId : 89fb0546-451e-48e2-966d-dee4d2bc76e4
2024-11-20 12:57:46.804 +05:00 [INF] Property code : 2823
2024-11-20 12:57:46.888 +05:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 12:57:46.891 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 86 ms
2024-11-20 12:57:46.901 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 12:57:46.910 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 400 null application/problem+json; charset=utf-8 176.4284ms
2024-11-20 13:01:54.202 +05:00 [INF] Application is shutting down...
2024-11-20 13:01:57.760 +05:00 [INF] Registered 7 endpoints in 78 milliseconds.
2024-11-20 13:01:58.297 +05:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 13:01:58.414 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 13:01:58.428 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 13:01:58.610 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 13:01:58.611 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 13:01:58.611 +05:00 [INF] Hosting environment: Development
2024-11-20 13:01:58.611 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 13:02:03.635 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 13:02:03.676 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:02:03.736 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 13:02:03.737 +05:00 [INF] Property confirmationId : 89fb0546-451e-48e2-966d-dee4d2bc76e4
2024-11-20 13:02:03.737 +05:00 [INF] Property code : 2823
2024-11-20 13:02:03.822 +05:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 13:02:03.825 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 88 ms
2024-11-20 13:02:03.836 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:02:03.845 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 400 null application/problem+json; charset=utf-8 210.6523ms
2024-11-20 13:02:10.322 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 13:02:10.327 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:02:10.327 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 13:02:10.328 +05:00 [INF] Property confirmationId : 89fb0546-451e-48e2-966d-dee4d2bc76e7
2024-11-20 13:02:10.328 +05:00 [INF] Property code : 2823
2024-11-20 13:02:10.372 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 13:02:10.374 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 45 ms
2024-11-20 13:02:10.375 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:02:10.376 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 400 null application/problem+json; charset=utf-8 54.0781ms
2024-11-20 13:02:20.463 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 13:02:20.465 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:02:20.466 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 13:02:20.466 +05:00 [INF] Property confirmationId : 89fb0546-451e-48e2-966d-dee4d2bc76e9
2024-11-20 13:02:20.466 +05:00 [INF] Property code : 2823
2024-11-20 13:02:20.477 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 13:02:20.535 +05:00 [INF] Executed DbCommand (6ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "AspNetUsers" AS a
    WHERE a."PhoneNumber" = @__phoneNumber_0)
2024-11-20 13:02:20.538 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 71 ms
2024-11-20 13:02:20.539 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:02:20.539 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 400 null application/problem+json; charset=utf-8 76.5527ms
2024-11-20 13:03:13.996 +05:00 [INF] Application is shutting down...
2024-11-20 13:07:32.668 +05:00 [INF] Registered 7 endpoints in 89 milliseconds.
2024-11-20 13:07:33.320 +05:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 13:07:33.504 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 13:07:33.531 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 13:07:33.781 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 13:07:33.781 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 13:07:33.781 +05:00 [INF] Hosting environment: Development
2024-11-20 13:07:33.781 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 13:08:20.545 +05:00 [INF] Application is shutting down...
2024-11-20 13:08:21.986 +05:00 [INF] Registered 7 endpoints in 77 milliseconds.
2024-11-20 13:08:22.529 +05:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 13:08:22.646 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 13:08:22.660 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 13:08:22.830 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 13:08:22.830 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 13:08:22.830 +05:00 [INF] Hosting environment: Development
2024-11-20 13:08:22.830 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 13:08:28.461 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 13:08:28.514 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:08:28.565 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 13:08:28.565 +05:00 [INF] Property confirmationId : 89fb0546-451e-48e2-966d-dee4d2bc76e9
2024-11-20 13:08:28.565 +05:00 [INF] Property code : 2823
2024-11-20 13:08:28.642 +05:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 13:08:28.682 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "AspNetUsers" AS a
    WHERE a."PhoneNumber" = @__phoneNumber_0)
2024-11-20 13:08:28.801 +05:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?', @p2='?', @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTime), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?', @p11='?', @p12='?' (DbType = Boolean), @p13='?', @p14='?' (DbType = Boolean), @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("AccessFailedCount", "ConcurrencyStamp", "Email", "EmailConfirmed", "IsActive", "LastLogin", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "SecurityStamp", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15)
RETURNING "Id";
2024-11-20 13:08:28.819 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Email", a."EmailConfirmed", a."IsActive", a."LastLogin", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."PhoneNumber" = @__phoneNumber_0
LIMIT 1
2024-11-20 13:08:28.826 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:08:28.830 +05:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 's')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Text.Encoding.GetBytes(String s)
   at Experiments.Infrastructure.Identity.Jwt.JwtService.GenerateJwtAsync(AppUser user) in /Users/arman/RiderProjects/Experiments/src/Experiments.Infrastructure/Identity/Jwt/JwtService.cs:line 14
   at Experiments.Infrastructure.Identity.IdentityService.SignInOrSignUpAsync(String phoneNumber) in /Users/arman/RiderProjects/Experiments/src/Experiments.Infrastructure/Identity/IdentityService.cs:line 33
   at Experiments.UseCases.Auth.Confirm.AuthConfirmCommandHandler.Handle(AuthConfirmCommand request, CancellationToken cancellationToken) in /Users/arman/RiderProjects/Experiments/src/Experiments.UseCases/Auth/Confirm/AuthConfirmCommandHandler.cs:line 30
   at Ardalis.SharedKernel.LoggingBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)
   at Experiments.Web.Auth.Confirm.AuthConfirm.HandleAsync(AuthConfirmRequest req, CancellationToken ct) in /Users/arman/RiderProjects/Experiments/src/Experiments.Web/Auth/Confirm/AuthConfirm.cs:line 15
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at NSwag.AspNetCore.Middlewares.SwaggerUiIndexMiddleware.Invoke(HttpContext context)
   at NSwag.AspNetCore.Middlewares.RedirectToIndexMiddleware.Invoke(HttpContext context)
   at NSwag.AspNetCore.Middlewares.OpenApiDocumentMiddleware.Invoke(HttpContext context)
   at Ardalis.ListStartupServices.ShowAllServicesMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-11-20 13:08:28.847 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 500 null text/plain; charset=utf-8 387.3705ms
2024-11-20 13:09:00.398 +05:00 [INF] Application is shutting down...
2024-11-20 13:39:50.526 +05:00 [INF] Registered 7 endpoints in 86 milliseconds.
2024-11-20 13:39:51.105 +05:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 13:39:51.223 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 13:39:51.235 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 13:39:51.395 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 13:39:51.395 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 13:39:51.395 +05:00 [INF] Hosting environment: Development
2024-11-20 13:39:51.395 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 13:39:57.438 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 13:39:57.463 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:39:57.540 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 13:39:57.541 +05:00 [INF] Property confirmationId : 89fb0546-451e-48e2-966d-dee4d2bc76e9
2024-11-20 13:39:57.541 +05:00 [INF] Property code : 2823
2024-11-20 13:39:57.626 +05:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 13:39:57.662 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 121 ms
2024-11-20 13:39:57.673 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:39:57.682 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 400 null application/problem+json; charset=utf-8 244.3351ms
2024-11-20 13:40:30.603 +05:00 [INF] Application is shutting down...
2024-11-20 13:48:07.284 +05:00 [INF] Registered 7 endpoints in 108 milliseconds.
2024-11-20 13:48:07.933 +05:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 13:48:08.059 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 13:48:08.071 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 13:48:08.227 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 13:48:08.228 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 13:48:08.228 +05:00 [INF] Hosting environment: Development
2024-11-20 13:48:08.228 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 13:48:11.228 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/start - application/json 35
2024-11-20 13:48:11.252 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/start'
2024-11-20 13:48:11.290 +05:00 [INF] Handling AuthStartCommand
2024-11-20 13:48:11.291 +05:00 [INF] Property phoneNumber : +77072780241
2024-11-20 13:48:11.400 +05:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Boolean), @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AuthConfirmations" ("Id", "Code", "IsConfirmed", "PhoneNumber")
VALUES (@p0, @p1, @p2, @p3);
2024-11-20 13:48:11.409 +05:00 [INF] Handled AuthStartCommand with Ardalis.Result.Result`1[System.String] in 118 ms
2024-11-20 13:48:11.415 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/start'
2024-11-20 13:48:11.424 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/start - 200 null application/json; charset=utf-8 196.4474ms
2024-11-20 13:48:25.973 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 13:48:25.981 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:48:25.999 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 13:48:26.000 +05:00 [INF] Property confirmationId : 30c04d7e-f58f-49ac-af99-475487998a01
2024-11-20 13:48:26.000 +05:00 [INF] Property code : 1337
2024-11-20 13:48:26.089 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 13:48:26.106 +05:00 [INF] Executed DbCommand (4ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "AspNetUsers" AS a
    WHERE a."PhoneNumber" = @__phoneNumber_0)
2024-11-20 13:48:26.112 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Email", a."EmailConfirmed", a."IsActive", a."LastLogin", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."PhoneNumber" = @__phoneNumber_0
LIMIT 1
2024-11-20 13:48:26.189 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2024-11-20 13:48:26.267 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?', @p1='?' (DbType = Boolean), @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AuthConfirmations" SET "Code" = @p0, "IsConfirmed" = @p1, "PhoneNumber" = @p2
WHERE "Id" = @p3;
2024-11-20 13:48:26.269 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 268 ms
2024-11-20 13:48:26.273 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:48:26.273 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 200 null application/json; charset=utf-8 299.9431ms
2024-11-20 13:51:31.552 +05:00 [INF] Application is shutting down...
2024-11-20 13:57:45.708 +05:00 [INF] Registered 7 endpoints in 89 milliseconds.
2024-11-20 13:57:46.291 +05:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 13:57:46.412 +05:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 13:57:46.428 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 13:57:46.591 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 13:57:46.591 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 13:57:46.591 +05:00 [INF] Hosting environment: Development
2024-11-20 13:57:46.591 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 13:57:56.005 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/start - application/json 35
2024-11-20 13:57:56.025 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/start'
2024-11-20 13:57:56.094 +05:00 [INF] Handling AuthStartCommand
2024-11-20 13:57:56.095 +05:00 [INF] Property phoneNumber : +77072780241
2024-11-20 13:57:56.222 +05:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Boolean), @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AuthConfirmations" ("Id", "Code", "IsConfirmed", "PhoneNumber")
VALUES (@p0, @p1, @p2, @p3);
2024-11-20 13:57:56.232 +05:00 [INF] Handled AuthStartCommand with Ardalis.Result.Result`1[System.String] in 136 ms
2024-11-20 13:57:56.239 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/start'
2024-11-20 13:57:56.249 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/start - 200 null application/json; charset=utf-8 244.154ms
2024-11-20 13:58:12.518 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 13:58:12.524 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:58:12.541 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 13:58:12.542 +05:00 [INF] Property confirmationId : 483cd2bb-3b57-4bc0-abff-683eab70f3dc
2024-11-20 13:58:12.542 +05:00 [INF] Property code : 2536
2024-11-20 13:58:12.634 +05:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 13:58:12.652 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "AspNetUsers" AS a
    WHERE a."PhoneNumber" = @__phoneNumber_0)
2024-11-20 13:58:12.660 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Email", a."EmailConfirmed", a."IsActive", a."LastLogin", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."PhoneNumber" = @__phoneNumber_0
LIMIT 1
2024-11-20 13:58:12.737 +05:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2024-11-20 13:58:12.808 +05:00 [INF] Executed DbCommand (4ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?', @p1='?' (DbType = Boolean), @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AuthConfirmations" SET "Code" = @p0, "IsConfirmed" = @p1, "PhoneNumber" = @p2
WHERE "Id" = @p3;
2024-11-20 13:58:12.810 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 267 ms
2024-11-20 13:58:12.814 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 13:58:12.814 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 200 null application/json; charset=utf-8 296.1707ms
2024-11-20 13:59:33.695 +05:00 [INF] Application is shutting down...
2024-11-20 15:16:11.457 +05:00 [INF] Registered 8 endpoints in 100 milliseconds.
2024-11-20 15:16:12.061 +05:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 15:16:12.178 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 15:16:12.191 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 15:16:12.400 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 15:16:12.400 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 15:16:12.400 +05:00 [INF] Hosting environment: Development
2024-11-20 15:16:12.400 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 15:16:18.169 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/start - application/json 35
2024-11-20 15:16:18.212 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/start'
2024-11-20 15:16:18.254 +05:00 [INF] Handling AuthStartCommand
2024-11-20 15:16:18.254 +05:00 [INF] Property phoneNumber : +77072780241
2024-11-20 15:16:18.369 +05:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Boolean), @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AuthConfirmations" ("Id", "Code", "IsConfirmed", "PhoneNumber")
VALUES (@p0, @p1, @p2, @p3);
2024-11-20 15:16:18.380 +05:00 [INF] Handled AuthStartCommand with Ardalis.Result.Result`1[System.String] in 125 ms
2024-11-20 15:16:18.386 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/start'
2024-11-20 15:16:18.396 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/start - 200 null application/json; charset=utf-8 228.186ms
2024-11-20 15:16:34.922 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 15:16:34.926 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 15:16:34.938 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 15:16:34.938 +05:00 [INF] Property confirmationId : 07a3d1cc-5450-482e-896d-d26c31fd2a89
2024-11-20 15:16:34.938 +05:00 [INF] Property code : 5881
2024-11-20 15:16:35.043 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 15:16:35.061 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "AspNetUsers" AS a
    WHERE a."PhoneNumber" = @__phoneNumber_0)
2024-11-20 15:16:35.067 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Email", a."EmailConfirmed", a."IsActive", a."LastLogin", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."PhoneNumber" = @__phoneNumber_0
LIMIT 1
2024-11-20 15:16:35.132 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2024-11-20 15:16:35.163 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?', @p1='?' (DbType = Boolean), @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AuthConfirmations" SET "Code" = @p0, "IsConfirmed" = @p1, "PhoneNumber" = @p2
WHERE "Id" = @p3;
2024-11-20 15:16:35.165 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 226 ms
2024-11-20 15:16:35.169 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 15:16:35.169 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 200 null application/json; charset=utf-8 246.9487ms
2024-11-20 15:16:56.531 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/index.html - null null
2024-11-20 15:16:56.636 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/index.html - 200 null text/html; charset=utf-8 105.5897ms
2024-11-20 15:16:57.237 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - null null
2024-11-20 15:16:57.242 +05:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2024-11-20 15:16:57.468 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - 200 null application/json; charset=utf-8 230.8046ms
2024-11-20 15:17:04.042 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/profile/set-username - application/json 31
2024-11-20 15:17:04.091 +05:00 [INF] Executing endpoint 'HTTP: POST /profile/set-username'
2024-11-20 15:17:04.096 +05:00 [INF] Executed endpoint 'HTTP: POST /profile/set-username'
2024-11-20 15:17:04.097 +05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Experiments.Web.Profile.SetUserName.SetUserName.HandleAsync(SetUserNameRequest req, CancellationToken ct) in /Users/arman/RiderProjects/Experiments/src/Experiments.Web/Profile/SetUserName/SetUserName.cs:line 15
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at NSwag.AspNetCore.Middlewares.SwaggerUiIndexMiddleware.Invoke(HttpContext context)
   at NSwag.AspNetCore.Middlewares.RedirectToIndexMiddleware.Invoke(HttpContext context)
   at NSwag.AspNetCore.Middlewares.OpenApiDocumentMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Ardalis.ListStartupServices.ShowAllServicesMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-11-20 15:17:04.112 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/profile/set-username - 500 null text/plain; charset=utf-8 69.2781ms
2024-11-20 15:25:13.609 +05:00 [INF] Application is shutting down...
2024-11-20 15:25:16.141 +05:00 [INF] Registered 8 endpoints in 78 milliseconds.
2024-11-20 15:25:16.726 +05:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 15:25:16.843 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 15:25:16.856 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 15:25:17.016 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 15:25:17.016 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 15:25:17.016 +05:00 [INF] Hosting environment: Development
2024-11-20 15:25:17.016 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 15:25:22.810 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/profile/set-username - application/json 31
2024-11-20 15:25:22.877 +05:00 [INF] Executing endpoint 'HTTP: POST /profile/set-username'
2024-11-20 15:25:22.941 +05:00 [INF] Handling SetUserNameCommand
2024-11-20 15:25:22.942 +05:00 [INF] Property userName : vastellorde
2024-11-20 15:25:22.942 +05:00 [INF] Property userId : 1
2024-11-20 15:25:23.032 +05:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Email", a."EmailConfirmed", a."IsActive", a."LastLogin", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2024-11-20 15:25:23.095 +05:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Email", a."EmailConfirmed", a."IsActive", a."LastLogin", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2024-11-20 15:25:23.178 +05:00 [INF] Executed DbCommand (10ms) [Parameters=[@p16='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?', @p17='?', @p2='?', @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTime), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?', @p11='?', @p12='?' (DbType = Boolean), @p13='?', @p14='?' (DbType = Boolean), @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "ConcurrencyStamp" = @p1, "Email" = @p2, "EmailConfirmed" = @p3, "IsActive" = @p4, "LastLogin" = @p5, "LockoutEnabled" = @p6, "LockoutEnd" = @p7, "NormalizedEmail" = @p8, "NormalizedUserName" = @p9, "PasswordHash" = @p10, "PhoneNumber" = @p11, "PhoneNumberConfirmed" = @p12, "SecurityStamp" = @p13, "TwoFactorEnabled" = @p14, "UserName" = @p15
WHERE "Id" = @p16 AND "ConcurrencyStamp" = @p17;
2024-11-20 15:25:23.187 +05:00 [INF] Handled SetUserNameCommand with Ardalis.Result.Result in 244 ms
2024-11-20 15:25:23.190 +05:00 [INF] Executed endpoint 'HTTP: POST /profile/set-username'
2024-11-20 15:25:23.201 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/profile/set-username - 200 null null 391.3551ms
2024-11-20 15:26:44.710 +05:00 [INF] Application is shutting down...
2024-11-20 15:31:04.735 +05:00 [INF] Registered 9 endpoints in 91 milliseconds.
2024-11-20 15:31:05.333 +05:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 15:31:05.449 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 15:31:05.460 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 15:31:05.640 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 15:31:05.640 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 15:31:05.641 +05:00 [INF] Hosting environment: Development
2024-11-20 15:31:05.641 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 15:31:10.351 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/index.html - null null
2024-11-20 15:31:10.440 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/index.html - 200 null text/html; charset=utf-8 90.2377ms
2024-11-20 15:31:10.869 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - null null
2024-11-20 15:31:10.897 +05:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2024-11-20 15:31:11.242 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - 200 null application/json; charset=utf-8 372.9346ms
2024-11-20 15:31:37.287 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/profile/1 - null null
2024-11-20 15:31:37.326 +05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '11/20/2024 10:21:35 AM', Current time (UTC): '11/20/2024 10:31:37 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-11-20 15:31:37.332 +05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '11/20/2024 10:21:35 AM', Current time (UTC): '11/20/2024 10:31:37 AM'.
2024-11-20 15:31:37.334 +05:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2024-11-20 15:31:37.337 +05:00 [INF] AuthenticationScheme: Bearer was challenged.
2024-11-20 15:31:37.337 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/profile/1 - 401 0 null 50.0612ms
2024-11-20 15:33:04.394 +05:00 [INF] Application is shutting down...
2024-11-20 15:48:46.379 +05:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2024-11-20 15:48:46.481 +05:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2024-11-20 15:48:46.484 +05:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2024-11-20 15:48:46.484 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2024-11-20 15:48:46.485 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2024-11-20 15:48:46.488 +05:00 [INF] Applying migration '20241120104840_Sessions'.
2024-11-20 15:48:46.501 +05:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "RefreshTokens" (
    "Id" uuid NOT NULL,
    "IsRevoked" boolean NOT NULL,
    CONSTRAINT "PK_RefreshTokens" PRIMARY KEY ("Id")
);
2024-11-20 15:48:46.503 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Sessions" (
    "Id" uuid NOT NULL,
    "refreshTokenId" uuid NOT NULL,
    "Platform" integer NOT NULL,
    "userId" integer NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_Sessions" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_Sessions_RefreshTokens_refreshTokenId" FOREIGN KEY ("refreshTokenId") REFERENCES "RefreshTokens" ("Id") ON DELETE CASCADE
);
2024-11-20 15:48:46.504 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_Sessions_refreshTokenId" ON "Sessions" ("refreshTokenId");
2024-11-20 15:48:46.505 +05:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20241120104840_Sessions', '9.0.0');
2024-11-20 15:50:35.240 +05:00 [INF] Registered 9 endpoints in 106 milliseconds.
2024-11-20 15:50:35.977 +05:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 15:50:36.104 +05:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 15:50:36.118 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 15:50:36.275 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 15:50:36.275 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 15:50:36.275 +05:00 [INF] Hosting environment: Development
2024-11-20 15:50:36.275 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 15:50:38.481 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/index.html - null null
2024-11-20 15:50:38.567 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/index.html - 200 null text/html; charset=utf-8 87.0213ms
2024-11-20 15:50:39.033 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - null null
2024-11-20 15:50:39.037 +05:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2024-11-20 15:50:39.313 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - 200 null application/json; charset=utf-8 280.1616ms
2024-11-20 15:51:02.368 +05:00 [INF] Application is shutting down...
2024-11-20 16:19:40.030 +05:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2024-11-20 16:19:40.139 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2024-11-20 16:19:40.142 +05:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2024-11-20 16:19:40.143 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2024-11-20 16:19:40.143 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2024-11-20 16:19:40.147 +05:00 [INF] Applying migration '20241120111905_SessionsV2'.
2024-11-20 16:19:40.156 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Sessions" DROP COLUMN "userId";
2024-11-20 16:19:40.160 +05:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "RefreshTokens" ADD "UserId" integer NOT NULL DEFAULT 0;
2024-11-20 16:19:40.161 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "AuthConfirmations" ADD "Platform" text NOT NULL DEFAULT '';
2024-11-20 16:19:40.168 +05:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20241120111905_SessionsV2', '9.0.0');
2024-11-20 16:19:56.895 +05:00 [INF] Registered 9 endpoints in 97 milliseconds.
2024-11-20 16:19:57.516 +05:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )
2024-11-20 16:19:57.643 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Contributors" AS c)
2024-11-20 16:19:57.656 +05:00 [INF] User profile is available. Using '/Users/arman/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2024-11-20 16:19:57.826 +05:00 [INF] Now listening on: https://localhost:57679
2024-11-20 16:19:57.826 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-11-20 16:19:57.826 +05:00 [INF] Hosting environment: Development
2024-11-20 16:19:57.826 +05:00 [INF] Content root path: /Users/arman/RiderProjects/Experiments/src/Experiments.Web
2024-11-20 16:20:02.289 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/index.html - null null
2024-11-20 16:20:02.378 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/index.html - 200 null text/html; charset=utf-8 89.378ms
2024-11-20 16:20:02.798 +05:00 [INF] Request starting HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - null null
2024-11-20 16:20:02.811 +05:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2024-11-20 16:20:03.065 +05:00 [INF] Request finished HTTP/2 GET https://localhost:57679/swagger/v1/swagger.json - 200 null application/json; charset=utf-8 267.3366ms
2024-11-20 16:20:20.067 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/start - application/json 55
2024-11-20 16:20:20.079 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/start'
2024-11-20 16:20:20.150 +05:00 [INF] Handling AuthStartCommand
2024-11-20 16:20:20.151 +05:00 [INF] Property phoneNumber : +77027820241
2024-11-20 16:20:20.151 +05:00 [INF] Property platform : Pc
2024-11-20 16:20:20.270 +05:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Boolean), @p3='?', @p4='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AuthConfirmations" ("Id", "Code", "IsConfirmed", "PhoneNumber", "Platform")
VALUES (@p0, @p1, @p2, @p3, @p4);
2024-11-20 16:20:20.282 +05:00 [INF] Handled AuthStartCommand with Ardalis.Result.Result`1[System.String] in 131 ms
2024-11-20 16:20:20.286 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/start'
2024-11-20 16:20:20.290 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/start - 200 null application/json; charset=utf-8 222.97ms
2024-11-20 16:20:40.580 +05:00 [INF] Request starting HTTP/2 POST https://localhost:57679/auth/confirm - application/json 80
2024-11-20 16:20:40.592 +05:00 [INF] Executing endpoint 'HTTP: POST /auth/confirm'
2024-11-20 16:20:40.616 +05:00 [INF] Handling AuthConfirmCommand
2024-11-20 16:20:40.616 +05:00 [INF] Property confirmationId : c3657486-9446-47fa-a700-2c23c0933b50
2024-11-20 16:20:40.616 +05:00 [INF] Property code : 5482
2024-11-20 16:20:40.710 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Code", a."IsConfirmed", a."PhoneNumber", a."Platform"
FROM "AuthConfirmations" AS a
WHERE a."Id" = @__id_0
LIMIT 1
2024-11-20 16:20:40.731 +05:00 [INF] Executed DbCommand (5ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "AspNetUsers" AS a
    WHERE a."PhoneNumber" = @__phoneNumber_0)
2024-11-20 16:20:40.788 +05:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?', @p2='?', @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTime), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?', @p11='?', @p12='?' (DbType = Boolean), @p13='?', @p14='?' (DbType = Boolean), @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("AccessFailedCount", "ConcurrencyStamp", "Email", "EmailConfirmed", "IsActive", "LastLogin", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "SecurityStamp", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15)
RETURNING "Id";
2024-11-20 16:20:40.801 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__phoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Email", a."EmailConfirmed", a."IsActive", a."LastLogin", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."PhoneNumber" = @__phoneNumber_0
LIMIT 1
2024-11-20 16:20:40.834 +05:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2024-11-20 16:20:40.862 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?', @p1='?' (DbType = Boolean), @p2='?', @p3='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AuthConfirmations" SET "Code" = @p0, "IsConfirmed" = @p1, "PhoneNumber" = @p2, "Platform" = @p3
WHERE "Id" = @p4;
2024-11-20 16:20:40.918 +05:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Boolean), @p2='?' (DbType = Int32), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "RefreshTokens" ("Id", "IsRevoked", "UserId")
VALUES (@p0, @p1, @p2);
INSERT INTO "Sessions" ("Id", "CreatedAt", "Platform", "refreshTokenId")
VALUES (@p3, @p4, @p5, @p6);
2024-11-20 16:20:40.925 +05:00 [INF] Handled AuthConfirmCommand with Ardalis.Result.Result`1[Experiments.UseCases.Auth.JwtDto] in 308 ms
2024-11-20 16:20:40.929 +05:00 [INF] Executed endpoint 'HTTP: POST /auth/confirm'
2024-11-20 16:20:40.929 +05:00 [INF] Request finished HTTP/2 POST https://localhost:57679/auth/confirm - 200 null application/json; charset=utf-8 348.9232ms
2024-11-20 16:21:58.459 +05:00 [INF] Application is shutting down...
